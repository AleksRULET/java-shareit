CREATE TABLE IF NOT EXISTS USERS
(
    USER_ID    BIGINT GENERATED BY DEFAULT AS IDENTITY
            CONSTRAINT USERS_PK
               PRIMARY KEY,
    USER_NAME  VARCHAR(255) NOT NULL,
    USER_EMAIL VARCHAR(512) NOT NULL
        CONSTRAINT UQ_USER_EMAIL
            UNIQUE
);

CREATE TABLE IF NOT EXISTS REQUESTS
(
    REQUEST_ID          BIGINT GENERATED BY DEFAULT AS IDENTITY
        CONSTRAINT REQUESTS_PK
            PRIMARY KEY,
    REQUEST_DESCRIPTION VARCHAR(512),
    REQUESTOR_ID        BIGINT    NOT NULL
        CONSTRAINT REQUESTS_USERS_NULL_FK
            REFERENCES USERS
            ON DELETE CASCADE,
    REQUEST_CREATED     TIMESTAMP NOT NULL
);

CREATE TABLE IF NOT EXISTS ITEMS
(
    ITEM_ID          BIGINT GENERATED BY DEFAULT AS IDENTITY
        CONSTRAINT ITEMS_PK
            PRIMARY KEY,
    ITEM_NAME        VARCHAR(255) NOT NULL,
    ITEM_DESCRIPTION VARCHAR(512),
    IS_AVAILABLE     BOOLEAN      NOT NULL,
    OWNER_ID         BIGINT       NOT NULL
        CONSTRAINT ITEMS_USERS_NULL_FK
            REFERENCES USERS
            ON DELETE CASCADE,
    REQUEST_ID       BIGINT
        CONSTRAINT ITEMS_REQUESTS_NULL_FK
            REFERENCES REQUESTS
            ON DELETE SET NULL
);

CREATE TABLE IF NOT EXISTS BOOKINGS
(
    BOOKING_ID     BIGINT GENERATED BY DEFAULT AS IDENTITY
        CONSTRAINT BOOKINGS_PK
            PRIMARY KEY,
    BOOKING_START  TIMESTAMP   NOT NULL,
    BOOKING_END    TIMESTAMP   NOT NULL,
    ITEM_ID        BIGINT      NOT NULL
        CONSTRAINT BOOKINGS_ITEMS_NULL_FK
            REFERENCES ITEMS
            ON DELETE CASCADE,
    BOOKER_ID      BIGINT      NOT NULL
        CONSTRAINT BOOKINGS_USERS_NULL_FK
            REFERENCES USERS
            ON DELETE CASCADE,
    BOOKING_STATUS VARCHAR(10) NOT NULL
);

CREATE TABLE IF NOT EXISTS COMMENTS
(
    COMMENT_ID      BIGINT GENERATED BY DEFAULT AS IDENTITY
        CONSTRAINT COMMENTS_PK
            PRIMARY KEY,
    COMMENT_TEXT    VARCHAR(1025) NOT NULL,
    ITEM_ID         BIGINT        NOT NULL
        CONSTRAINT COMMENTS_ITEMS_NULL_FK
            REFERENCES ITEMS
            ON DELETE CASCADE,
    AUTHOR_ID       BIGINT        NOT NULL
        CONSTRAINT COMMENTS_USERS_NULL_FK
            REFERENCES USERS
            ON DELETE CASCADE,
    COMMENT_CREATED TIMESTAMP     NOT NULL
);




